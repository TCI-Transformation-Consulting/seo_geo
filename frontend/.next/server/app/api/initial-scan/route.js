"use strict";(()=>{var t={};t.id=274,t.ids=[274],t.modules={399:t=>{t.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:t=>{t.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7147:t=>{t.exports=require("fs")},2037:t=>{t.exports=require("os")},1017:t=>{t.exports=require("path")},402:(t,e,n)=>{n.r(e),n.d(e,{originalPathname:()=>P,patchFetch:()=>D,requestAsyncStorage:()=>j,routeModule:()=>$,serverHooks:()=>_,staticGenerationAsyncStorage:()=>E});var s={};n.r(s),n.d(s,{POST:()=>O});var o=n(9303),a=n(8716),i=n(670),r=n(7070),c=n(7280);let l=["Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36","Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:121.0) Gecko/20100101 Firefox/121.0","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.2 Safari/605.1.15"];async function u(t,e={},n=2){let s=e.timeout||5e3;for(let o=0;o<=n;o++){let n=l[o%l.length];try{let o;let a=new AbortController,i=setTimeout(()=>a.abort(),s),{signal:r,timeout:c,...l}=e;try{o=await fetch(t,{...l,headers:{...e.headers,"User-Agent":n,Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8","Accept-Language":"en-US,en;q=0.9","Accept-Encoding":"gzip, deflate, br"},signal:a.signal,cache:"no-store"})}catch(t){clearTimeout(i);continue}if(clearTimeout(i),!o.ok){try{await o.text()}catch{}if(403===o.status||429===o.status)continue;return null}return o}catch{continue}}return null}async function p(t,e=3e3){try{let n;let s=new AbortController,o=setTimeout(()=>s.abort(),e);try{n=await fetch(t,{method:"GET",headers:{"User-Agent":l[0],Accept:"*/*","Accept-Language":"en-US,en;q=0.9"},signal:s.signal,cache:"no-store"})}catch{return clearTimeout(o),{ok:!1,text:"",contentType:"",status:0}}if(clearTimeout(o),404===n.status)return{ok:!1,text:"",contentType:"",status:404};if(!n.ok){try{await n.text()}catch{}return{ok:!1,text:"",contentType:n.headers.get("content-type")||"",status:n.status}}let a=await n.text().catch(()=>"");return{ok:!0,text:a,contentType:n.headers.get("content-type")||"",status:n.status}}catch{return{ok:!1,text:"",contentType:"",status:0}}}let d={ecommerce:{average:42,top25:68,top10:85},saas:{average:51,top25:72,top10:88},media:{average:38,top25:61,top10:79},local_business:{average:28,top25:52,top10:71},general:{average:35,top25:58,top10:78}};async function m(t,e){try{return await t()}catch{return e}}async function h(t){let e=new URL(t).hostname.toLowerCase();if(["linkedin.com","facebook.com","instagram.com","twitter.com","x.com","tiktok.com","pinterest.com","reddit.com","amazon.com","xing.com"].some(t=>e.includes(t)))return await f(t);try{let e=await fetch("https://api.firecrawl.dev/v1/scrape",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${process.env.FIRECRAWL_API_KEY}`},body:JSON.stringify({url:t,formats:["html","markdown"],includeTags:["title","meta","h1","h2","h3","p","script","a"],waitFor:3e3})});if(403===e.status||!e.ok)return await f(t);let n=await e.json();return{status:"found",html:n.data?.html||"",markdown:n.data?.markdown||"",metadata:n.data?.metadata||{},links:n.data?.links||[]}}catch{return await f(t)}}async function f(t){try{let e=await fetch(t,{headers:{"User-Agent":"Mozilla/5.0 (compatible; AIReadinessBot/1.0; +https://example.com/bot)",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8","Accept-Language":"en-US,en;q=0.5"},signal:AbortSignal.timeout(1e4),redirect:"follow"});if(!e.ok)return{status:"check_failed",html:"",markdown:"",metadata:{},links:[],error:`HTTP ${e.status}: Could not access website`};let n=await e.text(),s=n.match(/<title[^>]*>([^<]+)<\/title>/i),o=n.match(/<meta[^>]*name=["']description["'][^>]*content=["']([^"']+)["']/i);return{status:"found",html:n,markdown:"",metadata:{title:s?.[1]||"",description:o?.[1]||""},links:[]}}catch(t){return{status:"check_failed",html:"",markdown:"",metadata:{},links:[],error:t instanceof Error?t.message:"Unknown error"}}}async function g(t){try{let e=new URL("/robots.txt",t).toString(),n=await p(e,5e3);if(!n.ok){if(404===n.status)return{status:"not_found",content:"",hasSitemap:!1,hasDisallow:!1};return{status:"check_failed",content:"",hasSitemap:!1,hasDisallow:!1,error:n.status?`HTTP ${n.status}`:"Failed to fetch robots.txt"}}let s=n.text,o=s.toLowerCase().includes("sitemap:"),a=s.toLowerCase().includes("disallow:"),i=!1,r=[],c=[],l=null;return s.split("\n").forEach(t=>{!(!(t=t.trim())||t.startsWith("#"))&&(t.toLowerCase().startsWith("user-agent:")?(l&&(l.userAgent.toLowerCase().includes("ai")||l.userAgent.toLowerCase().includes("gpt"))&&(i=!0,l.disallows.length>0&&r.push(`${l.userAgent} (Disallowed: ${l.disallows.join(", ")})`),l.allows.length>0&&c.push(`${l.userAgent} (Allowed: ${l.allows.join(", ")})`)),l={userAgent:t.substring(11).trim(),disallows:[],allows:[]}):t.toLowerCase().startsWith("disallow:")&&l?l.disallows.push(t.substring(9).trim()):t.toLowerCase().startsWith("allow:")&&l&&l.allows.push(t.substring(6).trim()))}),l&&(l.userAgent.toLowerCase().includes("ai")||l.userAgent.toLowerCase().includes("gpt"))&&(i=!0,l.disallows.length>0&&r.push(`${l.userAgent} (Disallowed: ${l.disallows.join(", ")})`),l.allows.length>0&&c.push(`${l.userAgent} (Allowed: ${l.allows.join(", ")})`)),{status:"found",content:s,hasSitemap:o,hasDisallow:a,hasAiDirectives:i,blockedBots:r,allowedBots:c}}catch(t){return{status:"check_failed",content:"",hasSitemap:!1,hasDisallow:!1,hasAiDirectives:!1,blockedBots:[],allowedBots:[],error:t instanceof Error?t.message:"Unknown error"}}}async function y(t){try{for(let e of["/sitemap.xml","/sitemap_index.xml","/sitemap/sitemap.xml"]){let n=new URL(e,t).toString(),s=await p(n,5e3);if(!s.ok)continue;let o=s.text;if(o.includes("<urlset")||o.includes("<sitemapindex")){let t=o.match(/<loc>(.*?)<\/loc>/g),e=t?.map(t=>t.replace(/<\/?loc>/g,""))||[];return{status:"found",urlCount:e.length,sitemapUrls:e.slice(0,10),url:n}}}return{status:"not_found",urlCount:0,sitemapUrls:[]}}catch(t){return{status:"check_failed",urlCount:0,sitemapUrls:[],error:t instanceof Error?t.message:"Unknown error"}}}async function w(t){for(let e of["/feed","/rss","/feed.xml","/rss.xml","/atom.xml"]){let n=new URL(e,t).toString(),s=await p(n,5e3);if(!s.ok)continue;let o=s.text;if(o.includes("<rss")||o.includes("<feed")||o.includes("<channel")){let t=o.match(/<item>|<entry>/g);return{status:"found",feedUrl:n,itemCount:t?.length||0}}}return{status:"not_found",itemCount:0}}async function S(t){try{let e=new URL("/llms.txt",t).toString(),n=await p(e,5e3);if(!n.ok||n.contentType.includes("text/html"))return{status:"not_found",content:"",hasInstructions:!1};let s=n.text;if(s.trim().startsWith("<!DOCTYPE")||s.trim().startsWith("<html")||s.trim().startsWith("<HTML"))return{status:"not_found",content:"",hasInstructions:!1};let o=s.length>50&&(s.toLowerCase().includes("llm")||s.toLowerCase().includes("ai")||s.toLowerCase().includes("model")||s.toLowerCase().includes("instruction"));return{status:"found",content:s,hasInstructions:o}}catch{return{status:"not_found",content:"",hasInstructions:!1}}}async function v(t){for(let e of["/.well-known/ai-manifest.json","/ai-manifest.json","/.well-known/ai-plugin.json"]){let n=new URL(e,t).toString(),s=await p(n,5e3);if(!s.ok||!s.contentType.includes("application/json")&&!s.contentType.includes("text/plain"))continue;let o=s.text;if(!(o.trim().startsWith("<!DOCTYPE")||o.trim().startsWith("<html")))try{let t=JSON.parse(o),e=t.api?.version||t.version;return{status:"found",content:o,version:e}}catch{continue}}return{status:"not_found",content:""}}async function k(t){for(let e of["/.well-known/mcp.json","/mcp.json"]){let n=new URL(e,t).toString(),s=await p(n,5e3);if(!s.ok||!s.contentType.includes("application/json")&&!s.contentType.includes("text/plain"))continue;let o=s.text;if(!(o.trim().startsWith("<!DOCTYPE")||o.trim().startsWith("<html")))try{let t=JSON.parse(o).tools||[];return{status:"found",content:o,tools:t}}catch{continue}}return{status:"not_found",content:""}}async function A(t){for(let e of["/openapi.json","/swagger.json","/api-docs","/api/openapi.json","/api/swagger.json"])try{let n=new URL(e,t).toString(),s=await p(n,5e3);if(!s.ok||!s.text||s.contentType.toLowerCase().includes("text/html"))continue;let o=s.text,a=o.trim();if(a.startsWith("<!DOCTYPE")||a.startsWith("<html")||a.startsWith("<HTML"))continue;try{let t=JSON.parse(o);if(t.openapi||t.swagger)return{status:"found",content:o,version:t.openapi||t.swagger}}catch{continue}}catch{continue}return{status:"not_found",content:""}}function b(t){let e;let n=[],s=[],o=/<script[^>]*type=["']application\/ld\+json["'][^>]*>([\s\S]*?)<\/script>/gi;for(;null!==(e=o.exec(t));)try{let t=JSON.parse(e[1]);n.push(t),Array.isArray(t)?t.forEach(t=>{t["@type"]&&s.push(Array.isArray(t["@type"])?t["@type"].join(", "):t["@type"])}):t["@type"]?s.push(Array.isArray(t["@type"])?t["@type"].join(", "):t["@type"]):t["@graph"]&&t["@graph"].forEach(t=>{if(t["@type"]){let e=t["@type"];s.push(Array.isArray(e)?e.join(", "):String(e))}})}catch{}return{types:[...new Set(s)],schemas:n}}async function C(t,e,n,s){let o=n||e.replace(/<[^>]+>/g," ").substring(0,15e3),a=s.title||"",i=new URL(t).hostname.replace("www.",""),r={topicRecognition:{primaryTopic:"Unknown",secondaryTopics:[],industry:"general",contentType:"webpage",keywords:[],entities:[],targetAudience:"General audience"},contentGap:{missingTopics:[],missingQuestions:[],contentScore:50,recommendations:["Unable to analyze content"]},napData:{name:null,address:null,phone:null,email:null,isComplete:!1},factCheck:{claims:[],overallCredibility:50,recommendations:[]},userQuestions:[]};if(o.trim().length<100)return r;try{let{text:e}=await (0,c._4)({model:"anthropic/claude-sonnet-4-20250514",prompt:`You are an AI content analyzer. Analyze this website thoroughly.

URL: ${t}
Domain: ${i}
Title: ${a}
Content (first 12000 chars): ${o.substring(0,12e3)}

IMPORTANT: Extract as much information as possible from the content. Even if information is limited, make educated guesses based on the domain name and any available text.

Respond with ONLY a valid JSON object (no markdown, no explanation):
{
  "topicRecognition": {
    "primaryTopic": "main topic based on content and domain name",
    "secondaryTopics": ["related topic 1", "related topic 2"],
    "industry": "one of: ecommerce, saas, media, local_business, education, healthcare, finance, technology, general",
    "contentType": "landing page, blog, product page, service page, corporate website, etc.",
    "keywords": ["key", "words", "from", "content"],
    "entities": [{"name": "company or brand name", "type": "organization"}],
    "targetAudience": "who this website is for"
  },
  "contentGap": {
    "missingTopics": ["important topics not covered"],
    "missingQuestions": ["questions visitors might have that aren't answered"],
    "contentScore": 65,
    "recommendations": ["specific improvement suggestions"]
  },
  "napData": {
    "name": "business name if found, otherwise null",
    "address": "full address if found, otherwise null",
    "phone": "phone number if found, otherwise null",
    "email": "email if found, otherwise null",
    "isComplete": false
  },
  "factCheck": {
    "claims": [{"claim": "any factual claims made", "verifiable": true, "issue": null}],
    "overallCredibility": 70,
    "recommendations": ["how to improve credibility"]
  },
  "userQuestions": ["what would someone ask an AI about this business?", "another likely question"]
}`}),n=e.trim();n.startsWith("```")&&(n=n.replace(/^```(?:json)?\n?/,"").replace(/\n?```$/,""));let s=n.match(/\{[\s\S]*\}/);s&&(n=s[0]);let l=JSON.parse(n);return{topicRecognition:{primaryTopic:l.topicRecognition?.primaryTopic||r.topicRecognition.primaryTopic,secondaryTopics:l.topicRecognition?.secondaryTopics||[],industry:l.topicRecognition?.industry||"general",contentType:l.topicRecognition?.contentType||"webpage",keywords:l.topicRecognition?.keywords||[],entities:l.topicRecognition?.entities||[],targetAudience:l.topicRecognition?.targetAudience||"General audience"},contentGap:{missingTopics:l.contentGap?.missingTopics||[],missingQuestions:l.contentGap?.missingQuestions||[],contentScore:l.contentGap?.contentScore||50,recommendations:l.contentGap?.recommendations||[]},napData:{name:l.napData?.name||null,address:l.napData?.address||null,phone:l.napData?.phone||null,email:l.napData?.email||null,isComplete:l.napData?.isComplete||!1},factCheck:{claims:l.factCheck?.claims||[],overallCredibility:l.factCheck?.overallCredibility||50,recommendations:l.factCheck?.recommendations||[]},userQuestions:l.userQuestions||[]}}catch{return r}}async function T(t,e,n,s,o,a){let i=new URL(t).hostname.replace("www.",""),r=n||e.replace(/<[^>]+>/g," ").substring(0,1e4),l=s.title||"";try{let{text:e}=await (0,c._4)({model:"anthropic/claude-sonnet-4-20250514",prompt:`Analyze this company/website to build a detailed profile for competitor identification.

URL: ${t}
Domain: ${i}
Title: ${l}
Known Business Name: ${o.name||"Unknown"}
Known Address: ${o.address||"Not found"}
Known Phone: ${o.phone||"Not found"}
Industry Hint: ${a.industry}
Primary Topic: ${a.primaryTopic}

Content excerpt:
${r.substring(0,8e3)}

Build a comprehensive company profile. Extract or infer:
1. Company name (from content, domain, or NAP data)
2. Industry/sector
3. Main services or products offered
4. Location (city, region/state, country) - extract from address, phone area code, content mentions
5. Target market (B2B, B2C, local, regional, national, international)
6. Unique selling points or differentiators
7. Business type (service provider, retailer, manufacturer, agency, nonprofit, media, etc.)

Return ONLY valid JSON:
{
  "companyName": "Company Name",
  "industry": "specific industry like digital sustainability, web development, local plumbing",
  "services": ["service 1", "service 2", "service 3"],
  "location": {
    "city": "City name or null",
    "region": "State/Region or null",
    "country": "Country or null"
  },
  "targetMarket": "local, regional, national, or international",
  "uniqueSellingPoints": ["what makes them different"],
  "businessType": "type of business"
}`}),n=e.replace(/```json\n?|\n?```/g,"").trim(),s=n.match(/\{[\s\S]*\}/),u=JSON.parse(s?s[0]:n);return{companyName:u.companyName||o.name||i,industry:u.industry||a.industry,services:u.services||[],location:{city:u.location?.city||null,region:u.location?.region||null,country:u.location?.country||null},targetMarket:u.targetMarket||"general",uniqueSellingPoints:u.uniqueSellingPoints||[],businessType:u.businessType||"business"}}catch{return{companyName:o.name||i,industry:a.industry,services:[],location:{city:null,region:null,country:null},targetMarket:"general",uniqueSellingPoints:[],businessType:"business"}}}async function x(t,e){let n=new URL(t).hostname.replace("www.",""),s=[e.location.city,e.location.region,e.location.country].filter(Boolean).join(", "),o=e.services.slice(0,5).join(", ")||e.industry,a=`
Company Profile:
- Name: ${e.companyName}
- Domain: ${n}
- Industry: ${e.industry}
- Services: ${o}
- Location: ${s||"Not specified"}
- Target Market: ${e.targetMarket}
- Business Type: ${e.businessType}
- Unique Selling Points: ${e.uniqueSellingPoints.join(", ")||"Not specified"}
`;console.log("[v0] Starting competitor search for:",n),console.log("[v0] Company profile:",JSON.stringify(e,null,2));try{let{text:t}=await (0,c._4)({model:"google/gemini-2.0-flash-001",providerOptions:{google:{useSearchGrounding:!0}},prompt:`Find direct competitors for this company. Use web search to find REAL, currently active competitors.

${a}

COMPETITOR SEARCH CRITERIA:
1. SAME LOCATION: If this is a local/regional business, find competitors in ${s||"the same area"}
2. SAME INDUSTRY: Must be in "${e.industry}" or closely related field
3. SAME SERVICES: Offering similar services: ${o}
4. SAME TARGET MARKET: Targeting ${e.targetMarket} customers
5. SIMILAR SIZE: Similar business type (${e.businessType})

For each competitor, identify:
- Their exact business name and website URL
- What services they offer that compete
- Why they are a direct competitor (be specific about overlap)
- Competitor type: "direct" (same services, same location), "indirect" (related services), or "aspirational" (larger player in same industry)

Return ONLY valid JSON array with 3-5 competitors:
[
  {
    "name": "Competitor Company Name",
    "url": "https://their-website.com",
    "description": "What they do and their main services",
    "reason": "Specific reason why they compete - mention shared location, services, or target market",
    "competitorType": "direct"
  }
]

IMPORTANT:
- Do NOT include ${n} or ${e.companyName}
- Only include REAL companies with working websites
- Prioritize competitors in ${s||"the same geographic market"} first
- If local business, focus on LOCAL competitors`});console.log("[v0] Gemini competitor search raw response:",t?.substring(0,500));let i=[];try{let e=JSON.parse(t||"[]");i=Array.isArray(e)?e:e.competitors||[],console.log("[v0] Parsed competitors count:",i.length),console.log("[v0] Competitor URLs:",i.map(t=>t.url))}catch(t){console.log("[v0] Failed to parse competitor JSON:",t);try{let{text:t}=await (0,c._4)({model:"anthropic/claude-sonnet-4-20250514",prompt:`Based on your knowledge, identify direct competitors for this company.

${a}

COMPETITOR SEARCH CRITERIA:
1. SAME LOCATION: If local/regional business in ${s||"unknown location"}, find competitors in that area
2. SAME INDUSTRY: Must be in "${e.industry}" industry
3. SAME SERVICES: Offering similar: ${o}
4. SAME TARGET: Targeting ${e.targetMarket} market

Find 3-5 real competitors. For local businesses, prioritize local competitors.

Return ONLY valid JSON array:
[
  {
    "name": "Competitor Name",
    "url": "https://competitor-website.com",
    "description": "What they do",
    "reason": "Why they compete - mention shared location/services/market",
    "competitorType": "direct"
  }
]

Do NOT include ${n}. Only real companies with actual websites.`}),r=t.replace(/```json\n?|\n?```/g,"").trim(),l=r.match(/\[[\s\S]*\]/),u=JSON.parse(l?l[0]:r);i=Array.isArray(u)?u:[],console.log("[v0] Claude fallback competitors count:",i.length),console.log("[v0] Claude fallback competitor URLs:",i.map(t=>t.url))}catch(t){return console.log("[v0] Claude fallback failed:",t instanceof Error?t.message:t),[]}}return i.slice(0,5).map(t=>({name:t.name||"Unknown",url:t.url||"",description:t.description||"",reason:t.reason||"",competitorType:t.competitorType||"direct"}))}catch(t){return console.log("[v0] Competitor search error:",t instanceof Error?t.message:t),[]}}async function L(t){let e=new URL(t).origin,n=0,s=!1;try{if(!(s=(await p(e,4e3)).ok))return{url:t,artifactCount:0,reachable:!1};n=(await Promise.allSettled([{path:"/robots.txt",weight:1},{path:"/sitemap.xml",weight:1},{path:"/llms.txt",weight:2},{path:"/.well-known/ai-manifest.json",weight:2},{path:"/feed",weight:1},{path:"/rss",weight:1}].map(async({path:t,weight:n})=>{let s=await p(`${e}${t}`,2500);if(!s.ok)return 0;if(t.includes(".json")){if(!s.contentType.includes("application/json"))return 0;try{return JSON.parse(s.text),n}catch{return 0}}return!s.contentType.includes("text/html")||t.includes(".txt")||("/feed"===t||"/rss"===t)&&(s.text.includes("<rss")||s.text.includes("<feed")||s.text.includes("<channel"))?n:0}))).reduce((t,e)=>"fulfilled"===e.status?t+e.value:t,0)}catch{return{url:t,artifactCount:0,reachable:!1}}return{url:t,artifactCount:n,reachable:s}}async function R(t){console.log("[v0] Scanning competitor artifacts for:",t);try{let[e,n,s,o,a,i]=await Promise.all([m(()=>g(t),{status:"not_found",content:"",hasSitemap:!1,hasDisallow:!1,hasAiDirectives:!1,blockedBots:[],allowedBots:[]}),m(()=>y(t),{status:"not_found",urlCount:0,sitemapUrls:[]}),m(()=>S(t),{status:"not_found",content:"",hasInstructions:!1}),m(()=>v(t),{status:"not_found",content:""}),m(()=>k(t),{status:"not_found",content:""}),m(()=>A(t),{status:"not_found",content:""})]);console.log("[v0] Artifact results for",t,":",{robots:e.status,sitemap:n.status,llms:s.status});let r="not_found",c=[],l=!1;try{let e=await u(t,{redirect:"follow",timeout:6e3},2);if(e&&e.ok){l=!0;let n=await e.text();console.log("[v0] HTML fetch success for",t,"- content length:",n.length),c=b(n).types,r=(await m(()=>w(t),{status:"not_found",itemCount:0})).status}else console.log("[v0] HTML fetch failed for",t,"- response:",e?.status)}catch(e){console.log("[v0] HTML fetch error for",t,":",e instanceof Error?e.message:e)}let p=c.length>0||"found"===e.status||"found"===n.status||"found"===r||"found"===s.status||"found"===o.status||"found"===a.status||"found"===i.status,d=p||l||"check_failed"!==e.status;return console.log("[v0] Crawl success for",t,":",d,"anyArtifactFound:",p),{jsonLdSchema:{status:c.length>0?"found":"not_found",types:c},robotsTxt:{status:e.status,hasAiDirectives:e.hasAiDirectives},sitemap:{status:n.status,urlCount:n.urlCount},rssFeed:{status:r},llmsTxt:{status:s.status},aiManifest:{status:o.status},mcpConfig:{status:a.status},openApi:{status:i.status},crawlSuccess:d}}catch(e){return console.log("[v0] scanCompetitorArtifacts error for",t,":",e instanceof Error?e.message:e),{jsonLdSchema:{status:"not_found",types:[]},robotsTxt:{status:"not_found",hasAiDirectives:!1},sitemap:{status:"not_found",urlCount:0},rssFeed:{status:"not_found"},llmsTxt:{status:"not_found"},aiManifest:{status:"not_found"},mcpConfig:{status:"not_found"},openApi:{status:"not_found"},crawlSuccess:!1}}}function I(t,e){let n=0,s=t.jsonLdSchema;s?.status==="found"&&(n+=Math.min(20,5+3*(s.types||[]).length));let o=t.robotsTxt;o?.status==="found"&&(n+=5,o.hasAiDirectives&&(n+=5));let a=t.sitemap;a?.status==="found"&&(n+=5,(a.urlCount||0)>10&&(n+=5));let i=t.rssFeed;i?.status==="found"&&(n+=5);let r=t.llmsTxt;r?.status==="found"&&(n+=15);let c=t.aiManifest;c?.status==="found"&&(n+=10);let l=t.mcpConfig;l?.status==="found"&&(n+=10);let u=t.openApi;return u?.status==="found"&&(n+=10),e?.contentGap?.contentScore&&(n+=Math.round(e.contentGap.contentScore/10)),Math.min(100,n)}let M=[{url:"https://stripe.com",name:"Stripe",description:"Payment processing platform with excellent technical SEO and AI readiness",reason:"Industry leader in developer experience and technical documentation"},{url:"https://vercel.com",name:"Vercel",description:"Cloud platform for frontend developers with strong AI optimization",reason:"Known for excellent structured data and modern web practices"},{url:"https://github.com",name:"GitHub",description:"Code hosting platform with comprehensive technical artifacts",reason:"Industry standard for developer tools with extensive schema markup"}];async function N(){for(let t of M)try{let e=await R(t.url);if(!e.crawlSuccess)continue;let n=["found"===e.jsonLdSchema.status,"found"===e.robotsTxt.status,"found"===e.sitemap.status,"found"===e.rssFeed.status,"found"===e.llmsTxt.status,"found"===e.aiManifest.status,"found"===e.mcpConfig.status,"found"===e.openApi.status].filter(Boolean).length;if(n>=4){let s=I(e,null);return{name:t.name,url:t.url,description:t.description,reason:t.reason,artifactChecks:e,score:s,isBenchmark:!0,crawledSuccessfully:!0,artifactsFoundCount:n,artifactsFoundPercentage:Math.round(n/8*100)}}}catch{continue}return null}async function O(t){try{let e=await t.json(),n=function(t){let e=t.trim();e.startsWith("http://")||e.startsWith("https://")||(e="https://"+e);try{return new URL(e),e}catch{throw Error("Invalid URL format")}}(e.url),s=new URL(n).origin,o=await h(n);if("check_failed"===o.status)return r.NextResponse.json({success:!1,error:o.error||"Failed to crawl website"},{status:400});let[a,i,c,l,u,p,m]=await Promise.all([g(s),y(s),w(s),S(s),v(s),k(s),A(s)]),f=b(o.html),M=function(t){let e;let n={},s=/<meta[^>]*>/gi;for(;null!==(e=s.exec(t));){let t=e[0].match(/(?:name|property)=["']([^"']+)["']/i),s=e[0].match(/content=["']([^"']+)["']/i);t&&s&&(n[t[1]]=s[1])}return n}(o.html),O=function(t){let e;let n=[],s=[],o=[],a=/<h1[^>]*>([\s\S]*?)<\/h1>/gi,i=/<h2[^>]*>([\s\S]*?)<\/h2>/gi,r=/<h3[^>]*>([\s\S]*?)<\/h3>/gi;for(;null!==(e=a.exec(t));)n.push(e[1].replace(/<[^>]+>/g,"").trim());for(;null!==(e=i.exec(t));)s.push(e[1].replace(/<[^>]+>/g,"").trim());for(;null!==(e=r.exec(t));)o.push(e[1].replace(/<[^>]+>/g,"").trim());return{h1:n,h2:s,h3:o}}(o.html),$=await C(n,o.html,o.markdown,o.metadata),j=await T(n,o.html,o.markdown,o.metadata,$.napData,$.topicRecognition),E=await x(n,j),_=await Promise.all(E.map(t=>L(t.url))),P=E.map((t,e)=>({...t,preScan:_[e]})).sort((t,e)=>t.preScan.reachable!==e.preScan.reachable?t.preScan.reachable?-1:1:e.preScan.artifactCount-t.preScan.artifactCount),D=await Promise.all(P.map(async t=>{let e=await R(t.url),n=I(e,null),s=[];"found"===e.jsonLdSchema.status&&0===f.types.length&&s.push(`Has structured data (${e.jsonLdSchema.types.join(", ")})`),"found"===e.llmsTxt.status&&"found"!==l.status&&s.push("Has llms.txt for AI instructions"),"found"===e.sitemap.status&&"found"!==i.status&&s.push("Has XML sitemap"),"found"===e.rssFeed.status&&"found"!==c.status&&s.push("Has RSS feed"),"found"===e.openApi.status&&"found"!==m.status&&s.push("Has OpenAPI specification");let o=["found"===e.jsonLdSchema.status,"found"===e.robotsTxt.status,"found"===e.sitemap.status,"found"===e.rssFeed.status,"found"===e.llmsTxt.status,"found"===e.aiManifest.status,"found"===e.mcpConfig.status,"found"===e.openApi.status].filter(Boolean).length;return{name:t.name,url:t.url,description:t.description,reason:t.reason,score:n,artifactChecks:e,advantages:s,crawledSuccessfully:e.crawlSuccess,foundCount:o,foundPercentage:o/8}})),U=D.filter(t=>t.crawledSuccessfully&&t.foundPercentage>=.6).sort((t,e)=>e.foundCount-t.foundCount)[0],G=null;(!U||U.foundCount<4)&&(G=await N());let F=D.map(t=>({name:t.name,url:t.url,description:t.description,reason:t.reason,score:t.score,artifactChecks:t.artifactChecks,advantages:t.advantages,crawledSuccessfully:t.crawledSuccessfully,isBenchmark:!G&&U?.url===t.url,artifactsFoundCount:t.foundCount,artifactsFoundPercentage:Math.round(100*t.foundPercentage)}));G&&F.unshift({name:G.name,url:G.url,description:G.description,reason:G.reason,score:G.score,artifactChecks:G.artifactChecks,advantages:["Reference benchmark demonstrating AI-ready artifacts"],crawledSuccessfully:!0,isBenchmark:!0,artifactsFoundCount:G.artifactsFoundCount,artifactsFoundPercentage:G.artifactsFoundPercentage});let W={jsonLdSchema:{status:f.types.length>0?"found":"not_found",types:f.types,schemas:f.schemas},robotsTxt:{status:a.status,content:a.content,hasAiDirectives:a.hasAiDirectives,blockedBots:a.blockedBots,allowedBots:a.allowedBots,error:a.error},sitemap:{status:i.status,url:i.url,urlCount:i.urlCount,error:i.error},rssFeed:{status:c.status,url:c.feedUrl,itemCount:c.itemCount,error:c.error},llmsTxt:{status:l.status,content:l.content,hasInstructions:l.hasInstructions,error:l.error},aiManifest:{status:u.status,content:u.content,version:u.version,error:u.error},mcpConfig:{status:p.status,content:p.content,tools:p.tools,error:p.error},openApi:{status:m.status,content:m.content,version:m.version,error:m.error}},B=I(W,$),q=d[$.topicRecognition.industry]||d.general,H=[];if("found"!==W.jsonLdSchema.status){let t=F.filter(t=>"found"===t.artifactChecks.jsonLdSchema.status);H.push({id:"no-schema",title:"Missing JSON-LD Structured Data",category:"schema",severity:"critical",description:"Your website lacks structured data markup that helps AI systems understand your content.",recommendation:"Add JSON-LD schemas for Organization, Product, FAQ, or Article depending on your content type.",competitorNote:t.length>0?`${t.length} of your competitors have structured data`:void 0,checkStatus:W.jsonLdSchema.status})}if("found"!==W.robotsTxt.status?H.push({id:"no-robots",title:"Missing robots.txt",category:"technical",severity:"warning",description:"No robots.txt file found. This file helps control how AI crawlers access your site.",recommendation:"Create a robots.txt file with appropriate directives for AI crawlers.",checkStatus:W.robotsTxt.status}):W.robotsTxt.hasAiDirectives||H.push({id:"no-ai-directives",title:"No AI Crawler Directives",category:"technical",severity:"suggestion",description:"Your robots.txt doesn't specify rules for AI crawlers like GPTBot or Claude-Web.",recommendation:"Add specific User-agent rules for AI crawlers to control how they index your content.",checkStatus:"found"}),"found"!==W.sitemap.status&&H.push({id:"no-sitemap",title:"Missing XML Sitemap",category:"technical",severity:"warning",description:"No sitemap.xml found. Sitemaps help AI systems discover all your content.",recommendation:"Generate and submit an XML sitemap to improve content discovery.",checkStatus:W.sitemap.status}),"found"!==W.llmsTxt.status){let t=F.filter(t=>"found"===t.artifactChecks.llmsTxt.status);H.push({id:"no-llms-txt",title:"Missing llms.txt",category:"ai",severity:"critical",description:"llms.txt is the emerging standard for providing instructions to AI language models.",recommendation:"Create an llms.txt file to guide how AI systems represent your brand and content.",competitorNote:t.length>0?`${t.length} competitors already have llms.txt`:void 0,checkStatus:W.llmsTxt.status})}if("found"!==W.rssFeed.status&&H.push({id:"no-rss",title:"Missing RSS Feed",category:"content",severity:"suggestion",description:"No RSS feed detected. RSS helps AI systems track your latest content updates.",recommendation:"Add an RSS feed to syndicate your content to AI aggregators.",checkStatus:W.rssFeed.status}),$.contentGap.missingTopics.length>0&&H.push({id:"content-gaps",title:"Content Gaps Identified",category:"content",severity:"warning",description:`Missing coverage of: ${$.contentGap.missingTopics.slice(0,3).join(", ")}`,recommendation:$.contentGap.recommendations[0]||"Expand content to cover missing topics.",checkStatus:"not_found"}),"local_business"===$.topicRecognition.industry&&!$.napData.isComplete){let t=[];$.napData.name||t.push("business name"),$.napData.address||t.push("address"),$.napData.phone||t.push("phone"),H.push({id:"incomplete-nap",title:"Incomplete Business Information (NAP)",category:"local",severity:"critical",description:`Missing: ${t.join(", ")}. Complete NAP data is essential for local AI visibility.`,recommendation:"Ensure your business name, address, and phone are clearly displayed and marked up with schema.",checkStatus:"not_found"})}let J=[];return"found"!==W.jsonLdSchema.status&&J.push({id:"add-schema",title:"Add Structured Data",description:"Implement JSON-LD schemas to boost AI understanding by up to 40%",impact:"high",estimatedScoreGain:20}),"found"!==W.llmsTxt.status&&J.push({id:"add-llms-txt",title:"Create llms.txt",description:"Guide AI systems on how to represent your brand accurately",impact:"high",estimatedScoreGain:15}),"found"!==W.openApi.status&&J.push({id:"add-openapi",title:"Add OpenAPI Specification",description:"Enable AI agents to interact with your services programmatically",impact:"medium",estimatedScoreGain:10}),r.NextResponse.json({success:!0,url:n,crawledAt:new Date().toISOString(),score:B,benchmarks:{industry:$.topicRecognition.industry,average:q.average,top25:q.top25,top10:q.top10,percentile:B>=q.top10?"top10":B>=q.top25?"top25":B>=q.average?"average":"below_average"},issues:{critical:H.filter(t=>"critical"===t.severity).length,warnings:H.filter(t=>"warning"===t.severity).length,suggestions:H.filter(t=>"suggestion"===t.severity).length},findings:H,opportunities:J,artifactChecks:W,analysis:{topicRecognition:$.topicRecognition,contentGap:$.contentGap,napData:$.napData,factCheck:$.factCheck,userQuestions:$.userQuestions},contentInfo:{title:o.metadata.title||M["og:title"]||"",description:M.description||M["og:description"]||"",headings:O,metaTagCount:Object.keys(M).length},competitors:F})}catch(t){return console.error("Initial scan error:",t),r.NextResponse.json({success:!1,error:t instanceof Error?t.message:"An error occurred during the scan"},{status:500})}}let $=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/initial-scan/route",pathname:"/api/initial-scan",filename:"route",bundlePath:"app/api/initial-scan/route"},resolvedPagePath:"/app/frontend/app/api/initial-scan/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:j,staticGenerationAsyncStorage:E,serverHooks:_}=$,P="/api/initial-scan/route";function D(){return(0,i.patchFetch)({serverHooks:_,staticGenerationAsyncStorage:E})}}};var e=require("../../../webpack-runtime.js");e.C(t);var n=t=>e(e.s=t),s=e.X(0,[948,972,280],()=>n(402));module.exports=s})();